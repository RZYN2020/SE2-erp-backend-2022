# ERP系统软件体系结构描述文档

> #### 5A652 杨峥 何浩达 赵勇臻 张岳轩
>
> 最后更改于2022/7/XX

| 修改人员 | 日期 | 修改原因 | 版本号 |
| -------- | ---- | -------- | ------ |
|          |      |          |        |
|          |      |          |        |

## 目录

[toc]

## 1. 引言

> 最后一次修改者：XXX
>
> 最后一次修改日期：2021/07/05

**1.1 编制目的**

本报告详细完成对ERP系统的概要设计，达到指导详细设计和开发的目的，同时实现和测试人员及用户的沟通。

本报告面向开发人员、测试人员及最终用户编写，是了解系统的导航。

**1.2 词汇表**

| 词汇名称 | 词汇含义          | 备注   |
| -------- | ----------------- | ------ |
| ERP      | 本项目开发的系统  | 无     |
| B/S      | 浏览器/服务器架构 | 无     |
| ......   | ......            | ...... |

**1.3 参考资料**

1. 整个ERP系统用例图
2. 库存模块用例描述
3. 销售模块需求规格说明

## 2. 产品描述

> 最后一次修改者：XXX
>
> 最后一次修改日期：2021/07/05

参考ERP系统用例文档和ERP系统软件需求规格说明文档对产品的概括描述。

## 3. 逻辑视角

> 最后一次修改者：XXX
>
> 最后一次修改日期：2021/07/05

ERP系统采用了分层体系结构风格，将系统分为三层（展示层，业务逻辑层，数据层），能够很好地示意整个高层抽象。展示层包含前端页面实现，业务逻辑层包含业务逻辑处理的实现，数据层负责数据持久化和访问。分层体系结构的逻辑视角和逻辑设计方案如下图1和图2所示。

![image-20220502210024307](https://seec-homework.oss-cn-shanghai.aliyuncs.com/logic.png)

<div align = "center">图1 参照体系结构风格的包图表达逻辑视角</div>

![Untitled Diagram](https://seec-homework.oss-cn-shanghai.aliyuncs.com/logic2.png)

<div align = "center">图2 软件体系结构逻辑设计方案 </div>

## 4. 组成视角

> 最后一次修改者：XXX
>
> 最后一次修改日期：2021/07/05

### 4.1 开发包图

> 下表仅涉及库存管理和销售模块相关部分

<div align = "center"> 表1 ERP系统的最终开发包设计</div>

| 开发（物理）包              | 依赖的其他开发包                                        |
| --------------------------- | ------------------------------------------------------- |
| erp.controller.sales        | erp.vo.salesVo, erp.service.sales, erp.util             |
| erp.service.sales           | erp.vo.salesVo                                          |
| erp.serviceimpl.sales       | erp.mapperservice.sales, erp.po.sales, erp.util         |
| erp.mapperservice.sales     | erp.po.sales                                            |
| erp.po.sales                | erp.vo.salesVo, erp.util                                |
| erp.vo.salesVo              | erp.po.sales, erp.util                                  |
| erp.controller.inventory    | erp.vo.inventoryVo, erp.service.inventory, erp.util     |
| erp.service.inventory       | erp.vo.inventoryVo                                      |
| erp.serviceimpl.inventory   | erp.mapperservice.inventory, erp.po.inventory, erp.util |
| erp.mapperservice.inventory | erp.po.inventory                                        |
| erp.po.inventory            | erp.vo.inventoryVo, erp.util                            |
| erp.vo.inventoryVo          | erp.po.inventory, erp.util                              |
| router                      | views                                                   |
| views                       | assets, common, components, mock, network, plugins      |

![image-20220502164708429](https://seec-homework.oss-cn-shanghai.aliyuncs.com/client-logic.png)

<div align = "center">图3 ERP系统浏览器端开发包图</div>

![image-20220502173822708](https://seec-homework.oss-cn-shanghai.aliyuncs.com/server-logic.png)

<div align = "center">图4 ERP系统服务器端开发包图</div>

### 4.2 物理部署

ERP系统采用B/S架构(浏览器/服务器架构)。代码分别部署在FrontendServer（需部署Node.js），BackendServer（需部署JDK，采用springboot框架），dataBaseServer（需部署MySQL）上。



![image-20220502205958027](https://seec-homework.oss-cn-shanghai.aliyuncs.com/phsical.png)

<div align = "center">图5 部署图</div>

## 5. 接口视角

### **5.1 模块的职责**

> 最后一次修改者：XXX
>
> 最后一次修改日期：2021/07/05

浏览器端和服务器端视图如图6和图7所示。浏览器各层和服务器端各层的职责如表2和表3所示。

![image-20220502115653817](https://seec-homework.oss-cn-shanghai.aliyuncs.com/client.png)

<div align = "center">图6 浏览器端模块视图</div>

![image-20220502115638769](https://seec-homework.oss-cn-shanghai.aliyuncs.com/server.png)

<div align = "center">图7 服务器端模块视图</div>

<div align = "center">表2 浏览器各层的职责</div>

| 层         | 职责                           |
| ---------- | ------------------------------ |
| 用户界面层 | 负责展示前端界面，并与用户交互 |
| 前端逻辑层 | 负责处理简单业务逻辑           |
| 网络模块   | 通过HTTP REST API与服务端交互  |

<div align = "center">表3 服务器各层的职责</div>

| 层         | 职责                                     |
| ---------- | ---------------------------------------- |
| 网络模块   | 负责HTTP通信服务，为浏览器提供前端资源   |
| 业务逻辑层 | 对从前端和浏览器端发来的请求进行业务处理 |
| 数据层     | 负责数据的持久化以及数据访问接口         |

每一层只是使用下方直接接触的层。层与层之间仅仅是通过接口的调用来完成的。层之间调用的接口如表4所示。

<div align = "center">表4 层之间调用接口</div>

| 接口                                                         | 服务调用方 | 服务提供方 |
| ------------------------------------------------------------ | ---------- | ---------- |
| InventoryService<br>SalesService<br>FinancialService<br>HRService<br>EnterpriseService | 前端逻辑层 | 业务逻辑层 |
| InventoryDao<br/>SalesDao<br/>FinancialDao<br/>HRDao<br/>EnterpriseDao | 业务逻辑层 | 数据层     |

重点描述库存模块和销售模块相关类的设计，包含库存模块和销售模块的业务逻辑层的接⼝规范和数据层的接⼝规范，和数据库设计。

### 5.2 用户界面层分解

> 最后一次修改者：XXX
>
> 最后一次修改日期：2021/07/05

根据需求，系统存在40个用户界面：登录界面，进货销售人员主界面，客户管理界面等。如图8所示。

![image-20220502181447387](https://seec-homework.oss-cn-shanghai.aliyuncs.com/ui.png)

<div align = "center">图8 用户界面跳转</div>

#### 5.2.1 用户界面层模块的职责

> 以下模块均以Inventory和Sales模块为例

| 模块      | 职责             |
| --------- | ---------------- |
| Inventory | 显示库存管理页面 |
| Sales     | 显示销售管理模块 |



#### 5.2.2 用户界面层模块需要的服务接口

##### 5.2.2.1 Inventory 模块

<table>  
<table >
<tr>
  <th rowspan="3">Intentory.api.product.queryAll</th>
</tr>
<tr>
  <td>前置条件</td>
  <td>用户进入仓库管理页面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>显示所有商品</td>
 <tr>
  <th rowspan="3">Intentory.api.product.update</th>
</tr>
<tr>
  <td>前置条件</td>
  <td>用户进入仓库管理页面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>更新商品信息</td>
</tr>
    <th rowspan="3">Intentory.api.product.create</th>
</tr>
<tr>
  <td>前置条件</td>
  <td>用户进入仓库管理页面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>创建新商品</td>
</tr>
  <th rowspan="3">Intentory.api.product.delete</th>
</tr>
<tr>
  <td>前置条件</td>
  <td>用户进入仓库管理页面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>删除该商品</td>
</tr>
  <th rowspan="3">Intentory.api.category.queryAll</th>
</tr>
<tr>
  <td>前置条件</td>
  <td>用户进入仓库管理页面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>显示所有商品分类</td>
</tr>
</tr>
  <th rowspan="3">Intentory.api.category.create</th>
</tr>
<tr>
  <td>前置条件</td>
  <td>用户进入仓库管理页面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>创建新商品分类</td>
</tr>
</tr>
  <th rowspan="3">Intentory.api.category.delete</th>
</tr>
<tr>
  <td>前置条件</td>
  <td>用户进入仓库管理页面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>删除该商品分类</td>
</tr>
<tr>
  <th rowspan="3">Intentory.api.category.update</th>
</tr>
<tr>
  <td>前置条件</td>
  <td>用户进入仓库管理页面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>更新商品信息</td>
</table>


##### 5.2.2.2 Sales 模块

<table>  
<tr>
    <th rowspan="3">Sales.api.customer.query</th>
<tr>
  <td>前置条件</td>
  <td>进入客户管理界面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>显示查询得出的客户</td>
</tr>
<tr>
    <th rowspan="3">Sales.api.customer.update</th>
<tr>
  <td>前置条件</td>
  <td>进入客户管理界面<td>
</tr>
<tr>
  <td>后置条件</td>
  <td>修改客户信息</td>
</tr>
  <th rowspan="3">Intentory.api.customer.create</th>
</tr>
<tr>
  <td>前置条件</td>
  <td>用户进入客户管理页面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>创建新客户</td>
</tr>
</tr>
  <th rowspan="3">Intentory.api.customer.delete</th>
</tr>
<tr>
  <td>前置条件</td>
  <td>用户进入客户管理页面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>删除该客户</td>
</tr>
 <tr>
    <th rowspan="3">Sales.api.CommodityInputSheet.send</th>
<tr>
  <td>前置条件</td>
  <td>进入进货单制定界面并填写完成必要信息</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>提交进货单以以供审批</td>
</tr>
 <tr>
    <th rowspan="3">Sales.api.CommodityInputSheet.input</th>
  </tr>
 <tr>
  <td>前置条件</td>
  <td>进入进货单制定界面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>填写完成进货单相关信息</td>
</tr>
   <tr>
    <th rowspan="3">Sales.api.CommodityInputSheet.update</th>
<tr>
  <td>前置条件</td>
  <td>进入进货单制定界面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>修改完成进货单有关信息</td>
</tr>
 <tr>
    <th rowspan="3">Sales.api.CommodityOutputSheet.send</th>
<tr>
  <td>前置条件</td>
  <td>进入退货单制定界面并填写完成必要信息</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>提交退货单以以供审批</td>
</tr>
 <tr>
    <th rowspan="3">Sales.api.CommodityOutputSheet.input</th>
  </tr>
 <tr>
  <td>前置条件</td>
  <td>进入退货单制定界面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>填写完成相关信息</td>
</tr>
   <tr>
    <th rowspan="3">Sales.api.CommodityOutputSheet.update</th>
<tr>
  <td>前置条件</td>
  <td>进入退货单制定界面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>修改完成退货单有关信息</td>
</tr>
  <tr>
    <th rowspan="3">Sales.api.SalesInputSheet.send</th>
<tr>
  <td>前置条件</td>
  <td>进入表单制定界面并填写完成必要信息</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>提交表单以以供审批</td>
</tr>
 <tr>
    <th rowspan="3">Sales.api.SalesInputSheet.input</th>
  </tr>
 <tr>
  <td>前置条件</td>
  <td>进入退货单制定界面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>填写完成相关信息</td>
</tr>
   <tr>
    <th rowspan="3">Sales.api.SalesInputSheet.update</th>
<tr>
  <td>前置条件</td>
  <td>进入退货单制定界面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>修改完成退货单有关信息</td>
</tr>
 <tr>
    <th rowspan="3">Sales.api.SalesOutputSheet.Sheet.send</th>
<tr>
  <td>前置条件</td>
  <td>进入销售单制定界面并填写完成必要信息</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>提交销售单以以供审批</td>
</tr>
 <tr>
    <th rowspan="3">Sales.api.SalesOutputSheet.input</th>
  </tr>
 <tr>
  <td>前置条件</td>
  <td>进入销售单制定界面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>填写完成相关信息</td>
</tr>
   <tr>
    <th rowspan="3">Sales.api.SalesOutputSheet.update</th>
<tr>
  <td>前置条件</td>
  <td>进入销售单制定界面</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>修改完成销售单单有关信息</td>
</tr>
<tr>
<th rowspan="3">Sales.api.CustomerWithLargestAmount</th>
<tr>
  <td>前置条件</td>
  <td>进入表单制定界面并填写完成必要信息</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>显示所查询销售人员某个时间段成交金额（订单数）最大的客户,系统显示相关信息</td>
</tr>
</table>



#### 5.2.2 用户界面层模块设计原理

用户界面利用vue来实现。

### 5.3 业务逻辑层分解

> 最后一次修改者：XXX
>
> 最后一次修改日期：2021/07/05

业务逻辑层包括多个针对界面的业务逻辑处理对象。例如`Inventory`负责处理库存界面的业务逻辑；`Sales`负责处理销售界面的业务逻辑

#### 5.3.1 业务逻辑层模块的职责

| 模块        | 职责                               |
| ----------- | ---------------------------------- |
| inventorybl | 负责实现对应于库存界面所需要的服务 |
| salesbl     | 负责实现销售界面所需要的服务       |
| ...         | ...                                |

#### 5.3.2 业务逻辑层模块的接口规范

<center><b>表 9 inventorybl模块的接口规范</b></center>

<center>提供的服务(供接口)</center>

<table>
<tr>
  <th rowspan="3">CategoryService.createCategory</th>
  <td>语法</td>
  <td>public CategoryVO createCategory(Integer parentId, String name);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>进入库存管理界面，输入的父结点id,分类名符合输入规则</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>查看是否存在响应父结点，将输入的分类名插入到父结点之下，返回分类信息</td>
</tr>
<tr>
  <th rowspan="3">CategoryService.deleteCategory</th>
  <td>语法</td>
  <td>public void deleteCategory(Integer id);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>进入库存管理页面，输入的商品分类id符合输入规则</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>查看是否存在该商品分类，如果存在则删除该分类以及其下的所有子分类</td>
</tr>
<tr>
  <th rowspan="3">ProductService.createProduct</th>
  <td>语法</td>
  <td>public ProductInfoVO createProduct(CreateProductVO inputVO);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>进入库存管理页面，输入的商品信息符合输入规则</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>根据输入的商品信息创建商品，返回商品信息</td>
</tr>  
<tr>
  <th rowspan="3">WarehouseService.productWarehousing</th>
  <td>语法</td>
  <td>public void productWarehousing(WarehouseInputFormVO warehouseInputFormVO);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>进入库存管理页面，填写符合规则的入库单并提交</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>入库单变为待审批状态</td>
</tr>
</table>


<center>需要的服务(需接口)</center>

| 服务名                                                     | 服务                             |
| ---------------------------------------------------------- | -------------------------------- |
| CategoryDAO.createCategory(CategoryPO categoryPO);         | 根据字段名和值插入单一持久化对象 |
| CategoryDAO.findByCategoryId(Integer categoryId)           | 根据字段名和值查找单一持久化对象 |
| CategoryDAO.findAll()                                      | 查找多个持久化对象               |
| CategoryDAO.updateById(CategoryPO categoryPO);             | 根据字段名和值更新单一持久化对象 |
| WarehouseDao.saveBatch(List\<WarehousePO> warehousePOList) | 在数据库中插入多个对象           |
| WarehouseOutputSheetDao.getLatest();                       | 获取最近一条出库单               |
| WarehouseInputSheetDao.save(WarehouseInputSheetPO toSave)  | 在数据库中插入一个出库单对象     |

<center><b>表 10 salesbl模块的接口规范</b></center>

<center>提供的服务(供接口)</center>

<table>
<tr>
  <th rowspan="3">CustomerService.createCustomer</th>
  <td>语法</td>
  <td>public CategoryVO createCategory(CustomerVO);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>进入销售界面，输入新增客户的信息</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>创建该客户</td>
</tr>
<tr>
  <th rowspan="3">CommodityService.purchasing</th>
  <td>语法</td>
  <td>public void purchasing(CommodityInputFormVO inputVO);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>进入销售界面, 填写并提交进货单</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>进货单变为待审核状态</td>
</tr>
<tr>
  <th rowspan="3">SalesService.saling</th>
  <td>语法</td>
  <td>public void saling(SalesInputVO inputVO);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>进入销售界面，填写并提交销售单</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>销售单变为待审核状态</td>
</tr>  
<tr>
  <th rowspan="3">CustomerService.customerWithLargestAmount</th>
  <td>语法</td>
  <td>public CustomerVO customerWithLargestAmount(int id, int begin, int end);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>进入销售分析页面，输入合法的销售人员id和时间间隔</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回该销售人员在该段时间内成交额最大的客户信息</td>
</tr>
</table>


| 服务名                                                       | 服务                               |
| ------------------------------------------------------------ | ---------------------------------- |
| CustomerDAO.createCustomer(CustomerPO customerPO);           | 根据字段名和值插入单一持久化对象   |
| CommodityInputSheetDao.getLatest();                          | 获取最近一条进货单                 |
| CommodityOutputSheetDao.save(CommodityOutputFormPO outputPO); | 根据字段名和值插入单一持久化对象   |
| SalesInputSheetDao.saveBatch(List\<SalesInputPO> salesPOList) | 在数据库中插入多个对象             |
| CustomerDAO.getCustomerWithLargestAmount(int id, int begin, int end) | 在数据库中检索符合条件的持久化对象 |

### 5.4 数据层分解

> 最后一次修改者：XXX
>
> 最后一次修改日期：2021/07/05

数据层主要给业务逻辑层提供数据访问服务。库存模块的业务逻辑层需要的服务由InventoryDao接口提供，具体描述如下图所示。

![image-20220502210342812](https://seec-homework.oss-cn-shanghai.aliyuncs.com/data.png)

<div align = "center">库存模块数据层模块的描述</div>

#### 5.4.1 库存模块数据层模块的职责

| 模块                    | 职责                                             |
| ----------------------- | ------------------------------------------------ |
| CategoryDao             | 商品分类管理接口，提供商品分类增、删、改、查服务 |
| ProductDao              | 商品管理接口，提供商品分类增、删、改、查服务     |
| UserDao                 | 用户接口，提供创建、查询用户服务                 |
| WarehouseDao            | 库存接口，提供批量保存、扣除数量、按序查找服务   |
| WarehouseInputSheetDao  | 入库单接口，提供获取、存入功能                   |
| WarehouseOutputSheetDao | 出库单接口，提供获取、存入功能                   |

**5.4.2 库存模块数据层模块的接口规范**

<table >
<tr>
  <th rowspan="3">CategoryDao.createCategory</th>
  <td>语法</td>
  <td>CategoryDao.createCategory(CategoryPO categoryPO);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>该条目在商品分类数据库中不存在</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中增加该商品分类条目</td>
</tr>
<tr>
  <th rowspan="3">CategoryDao.findByCategoryId</th>
  <td>语法</td>
  <td>CategoryDao.findByCategoryId(Integer categoryId);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>数据库中存在该商品分类</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中根据ID查询并返回该商品分类</td>
</tr>
<tr>
  <th rowspan="3">CategoryDao.findAll</th>
  <td>语法</td>
  <td>CategoryDao.findAll();</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回所有商品分类</td>
</tr>
    <tr>
  <th rowspan="3">CategoryDao.updateById</th>
  <td>语法</td>
  <td>CategoryDao.updateById();</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>在数据库中存在相同ID的categoryPO</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>更新该PO</td>
</tr>
<tr>
  <th rowspan="3">CategoryDao.deleteById</th>
  <td>语法</td>
  <td>CategoryDao.deleteById(Integer id);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>在数据库中存在相同ID的categoryPO</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>删除该PO</td>
</tr>
<tr>
  <th rowspan="3">ProductDao.createProduct</th>
  <td>语法</td>
  <td>ProductDao.createProduct(ProductPO productPO);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>同样ID的PO在数据库中不存在</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中增加一个productPO记录</td>
</tr>    
<tr>
  <th rowspan="3">ProductDao.updateById</th>
  <td>语法</td>
  <td>ProductDao.updateById(ProductPO productPO);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>在数据库中存在相同ID的productPO</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>更新该PO</td>
</tr>    
<tr>
  <th rowspan="3">ProductDao.deleteById</th>
  <td>语法</td>
  <td>ProductDao.deleteById(String id);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>在数据库中存在相同ID的productPO</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>删除该PO</td>
</tr>    
<tr>
  <th rowspan="3">ProductDao.findById</th>
  <td>语法</td>
  <td>ProductDao.findById(String id);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>数据库中存在该商品</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中根据ID查询并返回该productPO</td>
</tr>    
<tr>
  <th rowspan="3">ProductDao.findAll</th>
  <td>语法</td>
  <td>ProductDao.findAll();</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回所有productPO列表</td>
</tr>      
<tr>
  <th rowspan="3">UserDao.createUser</th>
  <td>语法</td>
  <td>UserDao.createUser(User user);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>同样ID的User在数据库中不存在</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中创建一个User</td>
</tr>     
<tr>
  <th rowspan="3">UserDao.findByUsernameAndPassword</th>
  <td>语法</td>
  <td>UserDao.findByUsernameAndPassword(String username, String password);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>根据username和password返回该user信息</td>
</tr>      
<tr>
  <th rowspan="3">WarehouseInputSheetDao.getLatest</th>
  <td>语法</td>
  <td>WarehouseInputSheetDao.getLatest();</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>获取最近一条入库单</td>
</tr>         
<tr>
  <th rowspan="3">WarehouseInputSheetDao.save</th>
  <td>语法</td>
  <td>WarehouseInputSheetDao.save(WarehouseInputSheetPO toSave);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>存入一条入库单记录</td>
</tr>      
<tr>
  <th rowspan="3">WarehouseInputSheetDao.saveBatch</th>
  <td>语法</td>
  <td>WarehouseInputSheetDao.saveBatch(List<WarehouseInputSheetContentPO> warehouseInputListPOSheetContent);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>把入库单上的具体内容存入数据库</td>
</tr>         
<tr>
  <th rowspan="3">WarehouseDao.saveBatch</th>
  <td>语法</td>
  <td>WarehouseDao.saveBatch(List<WarehousePO> warehousePOList);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>批量保存</td>
</tr>      
<tr>
  <th rowspan="3">WarehouseDao.deductQuantity</th>
  <td>语法</td>
  <td>WarehouseDao.deductQuantity(WarehousePO warehousePO);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>库存中相应商品数量不为0</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>扣除相应数量</td>
</tr>         
</table>    


注：出库单接口规范和入库单接口规范除了把入库单换成出库单以外没有任何区别，因此不再赘述。

![销售模块数据层分解](https://seec-homework.oss-cn-shanghai.aliyuncs.com/销售模块数据层分解.png)

<div align = "center">销售模块数据层模块的描述</div>

#### 5.4.3 销售模块数据层模块的职责

| 模块                   | 职责                                                     |
| ---------------------- | -------------------------------------------------------- |
| CustomerDao            | 客户信息管理接口，提供客户信息的增、删、改、查服务       |
| SalesInputSheetDao     | 销售单据管理接口，提供销售单据批量保存和获取功能         |
| SalesOuputSheetDao     | 销售退货单据管理接口，提供销售退货单据批量保存和获取功能 |
| CommodityInputSheetDao | 进货单据管理接口，提供进货单据批量保存和获取功能         |
| CommodityOuputSheetDao | 进货退货单据管理接口，提供进货退货单据批量保存和获取功能 |

#### 5.4.4 销售模块数据层模块的接口规范

<table>
<tr>
  <th rowspan="3">CustomerDao</th>
  <td>语法</td>
  <td>CustomerDao.createCustomer(CustomerPO customerPO);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>该客户在系统中不存在</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中增加该客户信息条目</td>
</tr>
<tr>
  <th rowspan="3">CommodityInputSheetDao</th>
  <td>语法</td>
  <td>CommodityInputSheetDao.getLatest();</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>获取最近一条进货单</td>
</tr>
<tr>
  <th rowspan="3">CommodityOutputSheetDao</th>
  <td>语法</td>
  <td>CommodityOutputSheetDao.save(CommodityOutputFormPO outputPO);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>存入一条进货退货单</td>
</tr>
<tr>
  <th rowspan="3">SalesInputSheetDao</th>
  <td>语法</td>
  <td>SalesInputSheetDao.saveBatch(List<SalesInputPO> salesPOList)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中批量存储一批销售单的内容</td>
</tr>
<tr>
  <th rowspan="3">CustomerDao</th>
  <td>语法</td>
  <td>CustomerDao.getCustomerWithLargestAmount(int id, int begin, int end)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>获取一段时间内最大交易量的客户的信息</td>
</tr>
</table>


## 6. 信息视角

> 最后一次修改者：XXX
>
> 最后一次修改日期：2021/07/05

### 6.1 数据持久化对象

系统的PO类就是对应的相关的实体类。在此只做部分PO的简单介绍。

- `Inventory包`：

包含商品分类信息类：

```java
@Data
public class CategoryPO {
	    /**
     * 分类id
     */
    private Integer id;

    /**
     * 分类名
     */
    private String name;

    /**
     * 父分类ID
     */
    private Integer parentId;

    /**
     * 是否为叶节点
     */
    private boolean isLeaf;

    /**
     * 商品数量
     */
    private Integer itemCount;

    /**
     * 下一个商品index
     */
    private Integer itemIndex;
}
```

商品信息类：

```java
public class ProductPO {

    /**
     * 商品id
     */
    private String id;

    /**
     * 商品名
     */
    private String name;

    /**
     * 分类ID
     */
    private Integer categoryId;

    /**
     * 商品型号
     */
    private String type;

    /**
     * 商品数量
     */
    private Integer quantity;

    /**
     *  进价
     */
    private BigDecimal purchasePrice;

    /**
     *  零售价
     */
    private BigDecimal retailPrice;

    /**
     *  最近进价
     */
    private BigDecimal recentPp;

    /**
     *  最近零售价
     */
    private BigDecimal recentRp;
}

```

+ `HR`包

User信息类：

```java
public class User {

    /**
     * 用户ID
     */
    private Integer id;

    /**
     * 用户姓名
     */
    private String name;

    /**
     * 用户密码
     */
    private String password;

    /**
     * 用户身份
     */
    private String role;

}
```

工资单类：

```java
public class SalaryRecepit {

    /**
     * 单据编号
     */
    private Integer recepitID;

    /**
     * 员工编号
     */
    private Integer id;

    /**
     * 姓名
     */
    private String name;

    /**
     * 银行工资信息
     */
    private Bankinfo info;
    
    /**
     * 应发工资
     */
    private Double salary;
    
    
    /**
     * 扣除税款
     */
    private Double taxe;
    
    
    /**
     * 实发金额
     */
    private Double tureSalary;
}
```



### 6.2 数据库表

数据库中包含SalaryRecepit表，Product表，Category表等。